<% layout('layouts/boilerplate') %>
<div id="cluster-map"></div>
<h1>All Campgrounds</h1>
<div>
	<a href="/spaces/new">add your space</a>
</div>
<% for (let space of spaces){ %>
	<div class="card mb-3">
		<div class="row">
			<div class="col-md-4">
				<% if(space.images.length){ %>
					<img class="img-fluid" alt="<%= space.title %>" src="<%=space.images[0].url%>">
				<% }else{ %>
					<img class="img-fluid" src="https://images.unsplash.com/photo-1528433556524-74e7e3bfa599?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1050&q=80" alt="default campground image">
				<% } %>
			</div>
			<div class="col-md-8">
				<h5 class="card-title"><%= space.title %></h5>
				<p class="card-text"><%= space.description %></p>
				<p class="card-text">
					<small class="text-muted"><%= space.location %></small>
				</p>
				<a class="btn btn-primary" href="/spaces/<%= space._id %>">View</a>
			</div>
		</div>	
	</div>
<% } %>
	
<script>
    const mapToken = '<%-process.env.MAPBOX_TOKEN%>';
    const spaces = { features: <%- JSON.stringify(spaces) %>}
</script>

<script src="/javascripts/clusterMap.js"></script>
			
		